<!DOCTYPE html>
<html>
<head>
    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Page Meta -->
    <title>Fun with AT commands and an old modem</title>
    <meta name="description" content="A place where I share my thoughts about programming." />

    <!-- Mobile Meta -->
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Brand icon -->
    <link rel="shortcut icon" href="/assets/images/favicon.ico" >

    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" />

    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!-- Ghost outputs important style and meta data with this tag -->
        <link rel="canonical" href="http://localhost:4000//fun-with-at-commands-and-old-modem" />
    <meta name="referrer" content="origin" />
    <link rel="next" href="/page2/" />

    <meta property="og:site_name" content="Programming is Magic" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Fun with AT commands and an old modem" />
    <meta property="og:description" content="A place where I share my thoughts about programming." />
    <meta property="og:url" content="http://localhost:4000//fun-with-at-commands-and-old-modem" />
    <meta property="og:image" content="/assets/images/mc_cover2.jpg" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Fun with AT commands and an old modem" />
    <meta name="twitter:description" content="A place where I share my thoughts about programming." />
    <meta name="twitter:url" content="http://localhost:4000//fun-with-at-commands-and-old-modem" />
    <meta name="twitter:image:src" content="/assets/images/mc_cover2.jpg" />

    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Website",
    "publisher": "Programming is Magic",
    "name": "Fun with AT commands and an old modem",
    "url": "http://localhost:4000//fun-with-at-commands-and-old-modem",
    "image": "/assets/images/mc_cover2.jpg",
    "description": "A place where I share my thoughts about programming."
}
    </script>

    <meta name="generator" content="Jekyll 3.0.0" />
    <link rel="alternate" type="application/rss+xml" title="Programming is Magic" href="/feed.xml" />


</head>
<body class="home-template nav-closed">

    <!-- The blog navigation links -->
    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        <li class="nav-home " role="presentation"><a href="/">Home</a></li>
        <!-- <li class="nav-about " role="presentation"><a href="/about">About</a></li> -->

        
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/java">
                    java (29)
                    <!-- fun-with-at-commands-and-old-modem name: java -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/dotnet">
                    dotnet (11)
                    <!-- fun-with-at-commands-and-old-modem name: dotnet -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/algorithms">
                    algorithms (7)
                    <!-- fun-with-at-commands-and-old-modem name: algorithms -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/architecture">
                    architecture (7)
                    <!-- fun-with-at-commands-and-old-modem name: architecture -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/scala">
                    scala (7)
                    <!-- fun-with-at-commands-and-old-modem name: scala -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/javascript">
                    javascript (5)
                    <!-- fun-with-at-commands-and-old-modem name: javascript -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/csharp">
                    csharp (4)
                    <!-- fun-with-at-commands-and-old-modem name: csharp -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/polish">
                    polish (4)
                    <!-- fun-with-at-commands-and-old-modem name: polish -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/elektronika">
                    elektronika (3)
                    <!-- fun-with-at-commands-and-old-modem name: elektronika -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/hibernate">
                    hibernate (3)
                    <!-- fun-with-at-commands-and-old-modem name: hibernate -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/linux">
                    linux (3)
                    <!-- fun-with-at-commands-and-old-modem name: linux -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/unit-testing">
                    unit-testing (3)
                    <!-- fun-with-at-commands-and-old-modem name: unit-testing -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/hardware-review">
                    hardware-review (2)
                    <!-- fun-with-at-commands-and-old-modem name: hardware-review -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/cheatsheet">
                    cheatsheet (1)
                    <!-- fun-with-at-commands-and-old-modem name: cheatsheet -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/devcon">
                    devcon (1)
                    <!-- fun-with-at-commands-and-old-modem name: devcon -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/eclipse">
                    eclipse (1)
                    <!-- fun-with-at-commands-and-old-modem name: eclipse -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/functional-programming">
                    functional-programming (1)
                    <!-- fun-with-at-commands-and-old-modem name: functional-programming -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/git">
                    git (1)
                    <!-- fun-with-at-commands-and-old-modem name: git -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/hacking">
                    hacking (1)
                    <!-- fun-with-at-commands-and-old-modem name: hacking -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/hardware">
                    hardware (1)
                    <!-- fun-with-at-commands-and-old-modem name: hardware -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/kotlin">
                    kotlin (1)
                    <!-- fun-with-at-commands-and-old-modem name: kotlin -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/low-level">
                    low-level (1)
                    <!-- fun-with-at-commands-and-old-modem name: low-level -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/other">
                    other (1)
                    <!-- fun-with-at-commands-and-old-modem name: other -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/postman">
                    postman (1)
                    <!-- fun-with-at-commands-and-old-modem name: postman -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/powershell">
                    powershell (1)
                    <!-- fun-with-at-commands-and-old-modem name: powershell -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/regex">
                    regex (1)
                    <!-- fun-with-at-commands-and-old-modem name: regex -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/security">
                    security (1)
                    <!-- fun-with-at-commands-and-old-modem name: security -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/sql">
                    sql (1)
                    <!-- fun-with-at-commands-and-old-modem name: sql -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/ssh">
                    ssh (1)
                    <!-- fun-with-at-commands-and-old-modem name: ssh -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/tips">
                    tips (1)
                    <!-- fun-with-at-commands-and-old-modem name: tips -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/vim">
                    vim (1)
                    <!-- fun-with-at-commands-and-old-modem name: vim -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/windows">
                    windows (1)
                    <!-- fun-with-at-commands-and-old-modem name: windows -->
                </a>
            </li>
        

   </ul>
    <a class="subscribe-button icon-feed" href="/feed.xml">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The comment above "< default" means - insert everything in this file into -->
    <!-- the [body] of the default.hbs template, which contains our header/footer. -->

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->



<header class="main-header post-head " style="background-image: url(/assets/images/mc_cover2.jpg) ">
    <nav class="main-nav  overlay  clearfix">
        <a class="blog-logo" href="/"><img src="/assets/images/home.png" alt="Blog Logo" /></a>
        
            <a class="menu-button icon-menu" href="#"><span class="word">Menu</span></a>
        
    </nav>
</header>

<main class="content" role="main">

    <article class="post tag-test tag-content">

        <header class="post-header">
            <h1 class="post-title">Fun with AT commands and an old modem</h1>
            <section class="post-meta">
            <!-- <a href='/'>mc</a> -->

            
                
                    <a href='/author/mc'>Marcin Chwedczuk</a>
                
            
            <time class="post-date" datetime="2019-09-21">21 Sep 2019</time>
                <!-- [[tags prefix=" on "]] -->
                
                on
                
                    
                       <a href='/tag/hacking'>Hacking</a>
                    
                
                
            </section>
        </header>

        <section class="post-content">

            <p>Recently, while cleaning my flat, I found an old Huawei E3131
USB modem. I planed to throw it away, but then I reminded myself
that this simple device, as virtually all modems, supports a
primitive text based interface known as “AT commands”.
And so I started thinking about
spending a few hours of my time
sending AT commands and figuring out what is actually
possible.
This post is the result of this few hours of hacking. Enjoy!</p>

<p>When I connected the modem to my PC it was immediately
recognized as both an USB Drive and an GSM modem.
Grepping through <code class="highlighter-rouge">dmesg</code> revealed that three serial port
terminals where created at <code class="highlighter-rouge">/dev/ttyUSB0</code>,
<code class="highlighter-rouge">/dev/ttyUSB1</code> and <code class="highlighter-rouge">/dev/ttyUSB2</code>:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">$ dmesg | grep tty
[29167.640728] usb 3-9: GSM modem (1-port) converter now attached to ttyUSB0
[29167.640808] usb 3-9: GSM modem (1-port) converter now attached to ttyUSB1
[29167.640861] usb 3-9: GSM modem (1-port) converter now attached to ttyUSB2</code></pre></figure>

<p>To be honest I expected only a single <code class="highlighter-rouge">tty</code> file…</p>

<p>Running <code class="highlighter-rouge">stty</code> command on <code class="highlighter-rouge">ttyUSB0</code> returned
some useful information, including
<a href="https://en.wikipedia.org/wiki/Symbol_rate">baud rate</a>:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">$ stty -F /dev/ttyUSB0
speed 9600 baud; line = 0;
eof = ^A; min = 1; time = 0;
-brkint -icrnl ixoff ixany -imaxbel
-opost -onlcr
-icanon -echo -echoe</code></pre></figure>

<p><code class="highlighter-rouge">-</code> before an option name means that this option is disabled.
Explanations for all options can be found in <code class="highlighter-rouge">man stty</code>.
For example <code class="highlighter-rouge">-echo</code> means that the characters that we
are writing, are not visible on the screen.
That is not very comfortable but can be changed easily
(you can try it yourself in bash by executing <code class="highlighter-rouge">stty -echo</code>
to disable
and <code class="highlighter-rouge">stty echo</code> to enable echo).</p>

<p>To connect to <code class="highlighter-rouge">ttyUSB0</code> I used <code class="highlighter-rouge">minicom</code>:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>apt install minicom</code></pre></figure>

<p>We need to create a <code class="highlighter-rouge">minicom</code> configuration first.
For some reason <code class="highlighter-rouge">minicom</code> was not
able to save it’s config file in my home directory and
insisted on saving it into <code class="highlighter-rouge">/etc/minicom/</code> and so I
have to run it with <code class="highlighter-rouge">sudo</code>:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>minicom <span class="nt">-s</span></code></pre></figure>

<p>Configuring <code class="highlighter-rouge">minicom</code> is like a journey to 80s,
entire UI is text based:
<img src="/assets/images/2019-09-23/mc-main-menu.png" alt="minicom main menu" />
First we need to go into “Serial port setup” section:
<img src="/assets/images/2019-09-23/mc-serial-port.png" alt="minicom serial port setting" />
and change “Serial Device” to <code class="highlighter-rouge">/dev/ttyUSB0</code> 
(to do this press A, change the field value and press either 
Enter to save or Escape to cancel).
Then we need to change baud rate (press E):
<img src="/assets/images/2019-09-23/mc-baud-rate.png" alt="minicom baud rate setting" />
On this screen press C and then Enter.
Next we need to go into “Screen and Keyboard” section and
enable echo (press Q) and then Enter:
<img src="/assets/images/2019-09-23/mc-scrn-kbd.png" alt="minicom screen and keyboard settings" />
We need to enable <em>local</em> echo (on the minicom side)
because, as <code class="highlighter-rouge">stty</code> indicated
the serial port itself does not support it.</p>

<p>Then we need to return to the main menu (press Enter)
and select “Save setup as…” option. I saved
my config under <code class="highlighter-rouge">huawei2</code> name. Then we should choose
“Exit from Minicom”. If you chose “Exit” use Ctrl+A
followed by X to exit.</p>

<p>Now we can start <code class="highlighter-rouge">minicom</code> without <code class="highlighter-rouge">sudo</code>:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">minicom huawei2</code></pre></figure>

<p>and execute our first AT command which is just <code class="highlighter-rouge">AT</code>.
The modem should respons with <code class="highlighter-rouge">OK</code> if everything works:
<img src="/assets/images/2019-09-23/mc-w1.png" alt="minicom working" /></p>

<p>To find out what options are supported by my
modem, I googled for “huawei e3131 at command interface specification”
and found a PDF document describing supported AT commands.
By the way AT commands are 
<a href="https://en.wikipedia.org/wiki/De_facto_standard">de facto standard</a>
and could be used with any modem.</p>

<p>TIP: To exit <code class="highlighter-rouge">minicom</code> press Ctrl+A followed by X (must be upper case).</p>

<p>WARNING: In the following sections I assume that we
inserted a working SIM card into the modem.</p>

<h4 id="obtaining-information-from-the-modem">Obtaining information from the modem</h4>

<p>We can obtain a lot of information about our modem and
the SIM card just by running AT commands.
For example we may ask the modem for its phone number:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">AT+CNUM

+CNUM: "NUMER WLASNY","+48999123999",145

OK</code></pre></figure>

<p>(“NUMER WLASNY” is “MY OWN NUMBER” in Polish),
or for its IMEI number:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">AT+CGSN

865459999999999

OK</code></pre></figure>

<p>To read a modem flag or a setting we need to run a command
in <code class="highlighter-rouge">AT+CMD?</code> format.
For example to obtain the character set used by the modem
we send <code class="highlighter-rouge">AT+CSCS?</code> command:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">AT+CSCS?

+CSCS: "IRA"

OK</code></pre></figure>

<p>To check what values are acceptable for this flag
we run a command in <code class="highlighter-rouge">AT+CMD=?</code> format:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">AT+CSCS=?

+CSCS: ("IRA","UCS2","GSM")

OK</code></pre></figure>

<p>And to set flag/setting value we execute 
a command in <code class="highlighter-rouge">AT+CMD=value</code> format like <code class="highlighter-rouge">AT+CSCS="GSM"</code>:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">AT+CSCS="GSM"

OK
AT+CSCS?

+CSCS: "GSM"

OK</code></pre></figure>

<p>Network signal strength can be checked using <code class="highlighter-rouge">AT+CSQ</code> command:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">AT+CSQ

+CSQ: 23,99

OK</code></pre></figure>

<p>The response has format <code class="highlighter-rouge">+CSQ: signal-strength, error-rate</code>.
Signal strength varies from 31 (very good)
to 0 (very poor / lack of signal).
In my case bit error rate is not supported (99) by the modem.</p>

<p><code class="highlighter-rouge">AT+COPS</code> command allows us to check the
current network and to get a list of
the present networks:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">AT+COPS?

+COPS: 0,0,"Plus",0

OK
AT+COPS=?

+COPS: (2,"Plus","PLUS","26001",0),
 (1,"Plus","PLUS","26001",2),
 (3,"T-Mobile PL","T-Mobile PL","26002",2),
 (3,"Orange PL","Orange","26003",2),
 //... OUTPUT TRUNCATED

OK</code></pre></figure>

<h4 id="sending-ussd-codes">Sending USSD codes</h4>

<p>USSD codes (short codes) like “*100#” are quite useful,
we can use them to check money amount on our account or
to change the current tariff.
Let’s see how to send them using AT commands.
First hurdle to overcome is 
the encoding used while sending an USSD code.
By default the codes must be encoded using
GSM7Bit encoding, which is not
related to 7-bit ASCII in any way.
I couldn’t find any online encoder/decoder for this
encoding, but fortunatelly
I found a pice of code that does exactly what we want:
<a href="https://github.com/bsimic0001/AegisWallet/blob/master/mobile/src/main/java/com/aegiswallet/utils/MessagingUtils.java">MessagingUtils.java</a>
And so I added a <code class="highlighter-rouge">main</code> method and pasted the code to 
<a href="https://www.compilejava.net/">www.compilejava.net</a>
to obtain an online converter. 
You can see the final, “paste ready” code
<a href="https://gist.github.com/marcin-chwedczuk/96f7f2a310ca416bed88a6dc10b7abc6">here</a>.</p>

<p>Encoding <code class="highlighter-rouge">*100#</code> in GSM7Bit gives us <code class="highlighter-rouge">AA180C3602</code>.
Now we may issue our USSD request using <code class="highlighter-rouge">AT+CUSD</code> command:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">OK
AT+CUSD=1,"AA180C3602",15

OK

+CUSD: 0,"C135BD1E66BBF3A0393DEC06ADDF6E7A1844668741EE7ABB2CAF8368B85C2E97CBE572B91C48078AB160301094E97481966F37FD0DBA87F5EE3288FC0691DDE93048866BC1722D192C9603C5623A1A4D378301",15</code></pre></figure>

<p><code class="highlighter-rouge">1</code> (first value in the request) means that we want to see the response,
<code class="highlighter-rouge">15</code> (the last value) is the encoding type that we are using.</p>

<p>Next we need to use our GSM7Bit decoder to obtain plain
text from the network response (in Polish):</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">Aktualny stan konta dla numeru 48999999999 : 1,00 PLN.
Konto wazne do dnia 28-09-2019 11:44:30</code></pre></figure>

<h4 id="sending-and-receiving-sms">Sending and receiving SMS</h4>

<p>Our next step will be to send and to receive an SMS:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">AT+CMGF=1

OK
AT+CMGS="+48333666999"

&gt; Hello, world!
+CMGS: 7

OK</code></pre></figure>

<p>Before we send a message we must switch to the text mode,
which can be done by issuing <code class="highlighter-rouge">AT+CMGF=1</code> command.
The default mode is the PDU mode, which requires
creating and parsing PDU binary frames.</p>

<p>To send an SMS <code class="highlighter-rouge">AT+CMGS="phone-number"</code> command is used.
After executing <code class="highlighter-rouge">AT+CMGS</code>, a command prompt (<code class="highlighter-rouge">&gt;</code>) will
appear allowing us to write our message.
When we are done we press Ctrl+Z,
few seconds later the message will be delivered.</p>

<p>To list received and sent messages we can use <code class="highlighter-rouge">AT+CMGL</code>
command:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">AT+CMGL=?

+CMGL: ("REC UNREAD","REC READ","STO UNSENT","STO SENT","ALL")

OK
AT+CMGL="ALL"

+CMGL: 0,"REC READ","+48111222333",,"19/09/23,16:01:42+08"
 Pszczolka Maja

OK</code></pre></figure>

<p>Remember to run this command in the text mode (<code class="highlighter-rouge">AT+CMGF=1</code>),
otherwise you will see hex encoded binary PDU frames.</p>

<p>First value in the row is the message index (<code class="highlighter-rouge">0</code>).
We may use this index to either read the message:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">AT+CMGR=0

+CMGR: "REC READ","+48111222333",,"19/09/23,16:13:03+08"
 Pszczolka Maja</code></pre></figure>

<p>or to remove it:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">AT+CMGD=0

OK
AT+CMGL="ALL"

OK</code></pre></figure>

<h4 id="playing-with-the-phone-book-entries">Playing with the phone book entries</h4>

<p><code class="highlighter-rouge">AT+CPBR</code> command can be used to read SIM card phone book entries:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">AT+CPBR=?

+CPBR: (1-250),40,20

OK
AT+CPBR=1,10

+CPBR: 1,"*110#",129,"Obsluga konta"
+CPBR: 2,"112",129,"Nr.alarmowy112"
+CPBR: 3,"999",129,"Pogotowie Rat."
+CPBR: 4,"997",129,"Policja"
+CPBR: 5,"998",129,"Straz pozarna"
+CPBR: 6,"+48601100100",145,"WOPR"
+CPBR: 7,"+48601100300",145,"GOPR/TOPR"
+CPBR: 8,"+48601102601",145,"Biuro obslugi"
+CPBR: 9,"5555",129,"Zasil konto"
+CPBR: 10,"*100#",129,"Stan konta"</code></pre></figure>

<p><code class="highlighter-rouge">AT+CPBR=?</code> returns supported range of indexes (<code class="highlighter-rouge">(1-250)</code>; some of them
may be empty), max. phone number length (<code class="highlighter-rouge">40</code>) and max.
entry name length (<code class="highlighter-rouge">20</code>).
Using this information we may read phone book entries using
<code class="highlighter-rouge">AT+CPBR=&lt;&lt;index-range&gt;&gt;</code> command.
When the phone number starts with <code class="highlighter-rouge">+</code> its type is <code class="highlighter-rouge">145</code>
otherwise its type is <code class="highlighter-rouge">129</code>.</p>

<p>Adding a phone book entry is very simple:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">AT+CPBW=25,"111222333",129,"foo"

OK
AT+CPBR=25

+CPBR: 25,"111222333",129,"foo"

OK</code></pre></figure>

<p>The same command can be used to remove a phone book entry:</p>

<figure class="highlight"><pre><code class="language-no-highlight" data-lang="no-highlight">AT+CPBW=25

OK
AT+CPBR=25

+CME ERROR: 22</code></pre></figure>

<h4 id="ring-ring-ring">RING RING RING</h4>

<p>AT commands can also be used to make and receive phone calls.
Voice is send/received in WAVE format.
Unfortunately I cannot obtain even a simplest <code class="highlighter-rouge">RING</code> notification
from my modem.</p>



        </section>

        <footer class="post-footer">

            <!-- Everything inside the #author tags pulls data from the author -->
            <!-- #author-->
            
                
                    
                        <figure class="author-image">
                            <a class="img" href="/author/mc" style="background-image: url(/assets/images/mc.png)"><span class="hidden">mc's Picture</span></a>
                        </figure>
                    

                    <section class="author">
                        <h4><a href="/author/mc">Marcin Chwedczuk</a></h4>

                        
                            <p> A programmer, a geek, a human</p>
                        
                        <div class="author-meta">
                            <span class="author-location icon-location"> Warsaw, Poland</span>
                            <span class="author-link icon-link"><a href="http://marcinchwedczuk.pl"> http://marcinchwedczuk.pl</a></span>
                        </div>
                    </section>

                    <!-- /author  -->

                    <section class="share">
                        <h4>Share this post</h4>
                        <a class="icon-twitter" href="http://twitter.com/share?text=Fun with AT commands and an old modem&amp;url=http://localhost:4000fun-with-at-commands-and-old-modem"
                            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                            <span class="hidden">Twitter</span>
                        </a>
                        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000fun-with-at-commands-and-old-modem"
                            onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                            <span class="hidden">Facebook</span>
                        </a>
                        <a class="icon-google-plus" href="https://plus.google.com/share?url=http://localhost:4000fun-with-at-commands-and-old-modem"
                           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                            <span class="hidden">Google+</span>
                        </a>
                    </section>
                
            

            <!-- Add Disqus Comments -->
            
                <div id="disqus_thread"></div>
<script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'marcinchwedczukgithubio'; // required: replace example with your forum shortname
        var disqus_identifier = '/fun-with-at-commands-and-old-modem';
        var disqus_url = 'http://localhost:4000/fun-with-at-commands-and-old-modem';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>

            

        </footer>

    </article>

</main>

<aside class="read-next">

    <!-- [[! next_post ]] -->
    
        <a class="read-next-story " style="background-image: url(/assets/images/mc_cover2.jpg)" href="/converting-dsl-files-to-kindle-dictionary">
            <section class="post">
                <h2>Converting .dsl files to Kindle dictionaries</h2>
                <p>In this post, I will describe how to convert dictionaries in [ABBYY Lingvo's format](http://lingvo.helpmax.net/en/troubleshooting/dsl-compiler/dsl-dictionary-structure/) to...</p>
            </section>
        </a>
    
    <!-- [[! /next_post ]] -->
    <!-- [[! prev_post ]] -->
    
        <a class="read-next-story prev " style="background-image: url(/assets/images/mc_cover3.jpg)" href="/ultimate-guide-to-scalas-match-expression">
            <section class="post">
                <h2>Ultimate guide to Scala's match expression</h2>
                <p>Scala match expression is a very powerful tool. In hands of an experienced developer it...</p>
            </section>
        </a>
    
    <!-- [[! /prev_post ]] -->
</aside>

<!-- /post -->


        <!-- The tiny footer at the very bottom -->
        <footer class="site-footer clearfix">
          <section class="copyright"><a href="/">Programming is Magic</a> &copy; 2021</section>
          <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> using <a href="https://github.com/jekyller/jasper">Jasper</a></section>
        </footer>
    </div>
    <!-- highlight.js -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- jQuery needs to come before `` so that jQuery can be used in code injection -->
    <script type="text/javascript" src="//code.jquery.com/jquery-1.12.0.min.js"></script>
    <!-- Ghost outputs important scripts and data with this tag -->
    <!--  -->
    <!-- Add Google Analytics  -->
        <!-- Google Analytics Tracking code -->
     <script>
	    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	    ga('create', 'UA-82096342-1', 'auto');
	    ga('send', 'pageview');

     </script>
    <!-- Fitvids makes video embeds responsive and awesome -->
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <!-- The main JavaScript file for Casper -->
    <script type="text/javascript" src="/assets/js/index.js"></script>

</body>
</html>
