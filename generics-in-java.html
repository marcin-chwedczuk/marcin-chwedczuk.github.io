<!DOCTYPE html>
<html>
<head>
    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Page Meta -->
    <title>Generics in Java</title>
    <meta name="description" content="A place where I share my thoughts about programming." />

    <!-- Mobile Meta -->
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Brand icon -->
    <link rel="shortcut icon" href="/assets/images/favicon.ico" >

    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" />

    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!-- Ghost outputs important style and meta data with this tag -->
        <link rel="canonical" href="http://blog.marcinchwedczuk.pl//generics-in-java" />
    <meta name="referrer" content="origin" />
    <link rel="next" href="/page2/" />

    <meta property="og:site_name" content="Programming is Magic" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Generics in Java" />
    <meta property="og:description" content="A place where I share my thoughts about programming." />
    <meta property="og:url" content="http://blog.marcinchwedczuk.pl//generics-in-java" />
    <meta property="og:image" content="/assets/images/mc_cover2.jpg" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Generics in Java" />
    <meta name="twitter:description" content="A place where I share my thoughts about programming." />
    <meta name="twitter:url" content="http://blog.marcinchwedczuk.pl//generics-in-java" />
    <meta name="twitter:image:src" content="/assets/images/mc_cover2.jpg" />

    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Website",
    "publisher": "Programming is Magic",
    "name": "Generics in Java",
    "url": "http://blog.marcinchwedczuk.pl//generics-in-java",
    "image": "/assets/images/mc_cover2.jpg",
    "description": "A place where I share my thoughts about programming."
}
    </script>

    <meta name="generator" content="Jekyll 3.0.0" />
    <link rel="alternate" type="application/rss+xml" title="Programming is Magic" href="/feed.xml" />


</head>
<body class="home-template nav-closed">

    <!-- The blog navigation links -->
    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        <li class="nav-home " role="presentation"><a href="/">Home</a></li>
        <!-- <li class="nav-about " role="presentation"><a href="/about">About</a></li> -->

        
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/java">
                    java (29)
                    <!-- generics-in-java name: java -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/dotnet">
                    dotnet (11)
                    <!-- generics-in-java name: dotnet -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/algorithms">
                    algorithms (7)
                    <!-- generics-in-java name: algorithms -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/architecture">
                    architecture (7)
                    <!-- generics-in-java name: architecture -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/scala">
                    scala (7)
                    <!-- generics-in-java name: scala -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/javascript">
                    javascript (5)
                    <!-- generics-in-java name: javascript -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/csharp">
                    csharp (4)
                    <!-- generics-in-java name: csharp -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/polish">
                    polish (4)
                    <!-- generics-in-java name: polish -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/elektronika">
                    elektronika (3)
                    <!-- generics-in-java name: elektronika -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/hibernate">
                    hibernate (3)
                    <!-- generics-in-java name: hibernate -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/linux">
                    linux (3)
                    <!-- generics-in-java name: linux -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/unit-testing">
                    unit-testing (3)
                    <!-- generics-in-java name: unit-testing -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/hardware-review">
                    hardware-review (2)
                    <!-- generics-in-java name: hardware-review -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/cheatsheet">
                    cheatsheet (1)
                    <!-- generics-in-java name: cheatsheet -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/ctf">
                    ctf (1)
                    <!-- generics-in-java name: ctf -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/devcon">
                    devcon (1)
                    <!-- generics-in-java name: devcon -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/eclipse">
                    eclipse (1)
                    <!-- generics-in-java name: eclipse -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/functional-programming">
                    functional-programming (1)
                    <!-- generics-in-java name: functional-programming -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/git">
                    git (1)
                    <!-- generics-in-java name: git -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/hacking">
                    hacking (1)
                    <!-- generics-in-java name: hacking -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/hardware">
                    hardware (1)
                    <!-- generics-in-java name: hardware -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/kotlin">
                    kotlin (1)
                    <!-- generics-in-java name: kotlin -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/low-level">
                    low-level (1)
                    <!-- generics-in-java name: low-level -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/other">
                    other (1)
                    <!-- generics-in-java name: other -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/postman">
                    postman (1)
                    <!-- generics-in-java name: postman -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/powershell">
                    powershell (1)
                    <!-- generics-in-java name: powershell -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/regex">
                    regex (1)
                    <!-- generics-in-java name: regex -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/security">
                    security (1)
                    <!-- generics-in-java name: security -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/sql">
                    sql (1)
                    <!-- generics-in-java name: sql -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/ssh">
                    ssh (1)
                    <!-- generics-in-java name: ssh -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/tips">
                    tips (1)
                    <!-- generics-in-java name: tips -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/vim">
                    vim (1)
                    <!-- generics-in-java name: vim -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/windows">
                    windows (1)
                    <!-- generics-in-java name: windows -->
                </a>
            </li>
        

   </ul>
    <a class="subscribe-button icon-feed" href="/feed.xml">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The comment above "< default" means - insert everything in this file into -->
    <!-- the [body] of the default.hbs template, which contains our header/footer. -->

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->



<header class="main-header post-head " style="background-image: url(/assets/images/mc_cover2.jpg) ">
    <nav class="main-nav  overlay  clearfix">
        <a class="blog-logo" href="/"><img src="/assets/images/home.png" alt="Blog Logo" /></a>
        
            <a class="menu-button icon-menu" href="#"><span class="word">Menu</span></a>
        
    </nav>
</header>

<main class="content" role="main">

    <article class="post tag-test tag-content">

        <header class="post-header">
            <h1 class="post-title">Generics in Java</h1>
            <section class="post-meta">
            <!-- <a href='/'>mc</a> -->

            
                
                    <a href='/author/mc'>Marcin Chwedczuk</a>
                
            
            <time class="post-date" datetime="2016-12-27">27 Dec 2016</time>
                <!-- [[tags prefix=" on "]] -->
                
                on
                
                    
                       <a href='/tag/java'>Java</a>
                    
                
                
            </section>
        </header>

        <section class="post-content">

            <p>Generics were introduced with Java 6 and quickly
become indispensable tool of every Java programmer.
In this blog post I gathered the most important
facts about generics in Java. After reading this post you
you should be able to comfortable use generics in
your code.</p>

<h4 id="generic-classes">Generic classes</h4>

<p>We can declare generic <code class="highlighter-rouge">Pair</code> class using syntax:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Pair</span><span class="o">&lt;</span><span class="n">E1</span><span class="o">,</span><span class="n">E2</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">E1</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">E2</span> <span class="n">second</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Pair</span><span class="o">(</span><span class="n">E1</span> <span class="n">first</span><span class="o">,</span> <span class="n">E2</span> <span class="n">second</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">E1</span> <span class="nf">getFirst</span><span class="o">()</span>  <span class="o">{</span> <span class="k">return</span> <span class="n">first</span><span class="o">;</span>  <span class="o">}</span>
    <span class="kd">public</span> <span class="n">E2</span> <span class="nf">getSecond</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">second</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>Then we can use <code class="highlighter-rouge">Pair</code> as follows:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// java 6:</span>
<span class="n">Pair</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">p1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Pair</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;(</span><span class="s">"foo"</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
  
<span class="n">String</span> <span class="n">first</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span>
<span class="kt">int</span> <span class="n">second</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="na">getSecond</span><span class="o">();</span>
  
<span class="c1">// java 7+ - using diamond operator &lt;&gt;</span>
<span class="n">Pair</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">p2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Pair</span><span class="o">&lt;&gt;(</span><span class="s">"foo"</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span></code></pre></figure>

<p>In Java 7 and later we can let compiler infer values of generic parameters
in <code class="highlighter-rouge">new</code> expression by using diamond operator (<code class="highlighter-rouge">&lt;&gt;</code>).</p>

<h5 id="bounds">Bounds</h5>

<p>We can reduce possible values of generic parameters by using bounds.
For example to reduce values of parameter <code class="highlighter-rouge">T</code> to types that
implement <code class="highlighter-rouge">Serializable</code> interface we can write:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SerializableList</span><span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Serializable</span><span class="o">&gt;</span> <span class="o">{</span> <span class="o">}</span></code></pre></figure>

<p>When using bounds we are not limited to single type.
For example we may
require that types allowed for <code class="highlighter-rouge">T</code> must extend <code class="highlighter-rouge">MyBaseClass</code> and
implement <code class="highlighter-rouge">Serializable</code> and <code class="highlighter-rouge">Cloneable</code> interfaces:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SerializableList2</span><span class="o">&lt;</span>
   <span class="n">T</span> <span class="kd">extends</span> <span class="n">MyBaseClass</span> <span class="o">&amp;</span> <span class="n">Serializable</span> <span class="o">&amp;</span> <span class="n">Cloneable</span><span class="o">&gt;</span> <span class="o">{</span> <span class="o">}</span></code></pre></figure>

<p>When we try to use <code class="highlighter-rouge">SerializableList</code> with types that doesn’t
conform to our bounds we will get compile-time error:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// ok</span>
<span class="n">SerializableList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ints</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SerializableList</span><span class="o">&lt;&gt;();</span>

<span class="c1">// error: type argument java.lang.Object is not within bounds of type-variable T</span>
<span class="n">SerializableList</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">objs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SerializableList</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;();</span></code></pre></figure>

<h5 id="type-erasure">Type erasure</h5>

<p>In Java generics are implemented via type erasure, this means that
generics exists only in Java source code and not in JVM bytecode.
When Java compiler translates generic classes to bytecode it
substitutes generic parameters in class body with <code class="highlighter-rouge">Object</code>
or if generic parameter has bounds with value of the first bound.
For example our <code class="highlighter-rouge">Pair</code> class would be translated by compiler into:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Pair</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Object</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Object</span> <span class="n">second</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Pair</span><span class="o">(</span><span class="n">Object</span> <span class="n">first</span><span class="o">,</span> <span class="n">Object</span> <span class="n">second</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">getFirst</span><span class="o">()</span>  <span class="o">{</span> <span class="k">return</span> <span class="n">first</span><span class="o">;</span>  <span class="o">}</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">getSecond</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">second</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>Compiler also inserts necessary casts, and converts between primitives 
and wrappers (e.g. between <code class="highlighter-rouge">int</code> and <code class="highlighter-rouge">Integer</code>) - a process
called (un)boxing. Continuing our example:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">pair</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Pair</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;(</span><span class="s">"foo"</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>

<span class="n">String</span> <span class="n">first</span> <span class="o">=</span> <span class="n">pair</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span>
<span class="kt">int</span> <span class="n">second</span> <span class="o">=</span> <span class="n">pair</span><span class="o">.</span><span class="na">getSecond</span><span class="o">();</span></code></pre></figure>

<p>is translated by compiler into:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">pair</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Pair</span><span class="o">(</span><span class="s">"foo"</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>

<span class="n">String</span> <span class="n">first</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span><span class="n">pair</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span>
<span class="kt">int</span> <span class="n">second</span> <span class="o">=</span> <span class="o">((</span><span class="n">Integer</span><span class="o">)</span><span class="n">pair</span><span class="o">.</span><span class="na">getSecond</span><span class="o">()).</span><span class="na">intValue</span><span class="o">();</span></code></pre></figure>

<p>Generics were implemented via type erasure to preserve binary
compatibility with pre Java 6 code (binary compatibility means that
your old code will work with generic types out of the box - you
don’t need to change or recompile your legacy libraries).</p>

<h5 id="shortcomings-of-type-erasure">Shortcomings of type erasure</h5>

<p>Type erasure is not the best way to implement generics, and IMHO Java
should take a different approach (e.g. reification).
But Java didn’t and we are stuck with “type erasure” generics.
Below is a list of Java generics shortcomings:</p>

<ul>
  <li>Primitive types like <code class="highlighter-rouge">int</code> cannot be used with generics.
 We may use generics with wrapper types e.g. <code class="highlighter-rouge">Integer</code> but this
 will incur performance penalty caused by casts and boxing/unboxing operations.</li>
  <li>We cannot use generic parameters in declarations of static class
 members. Static class members are shared between all instances of generic
 class regardless of generic parameters values. To stress this fact
 Java allows to access static members only via class name without
 generic parameters:</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">Example</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="c1">// error: non-static type variable T cannot be referenced from a static context</span>
    <span class="c1">// private static T last;</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printCounter</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"counter: "</span> <span class="o">+</span> <span class="n">counter</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">Example</span><span class="o">()</span> <span class="o">{</span> <span class="n">counter</span><span class="o">++;</span> <span class="o">}</span>
<span class="o">}</span>

<span class="k">new</span> <span class="n">Example</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
<span class="k">new</span> <span class="n">Example</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>

<span class="c1">// error: not a statement</span>
<span class="c1">// Example&lt;Integer&gt;.printCounter();</span>

<span class="c1">// prints counter: 2</span>
<span class="n">Example</span><span class="o">.</span><span class="na">printCounter</span><span class="o">();</span></code></pre></figure>

<ul>
  <li>Sometimes Java compiler must create synthetic methods
 (in this case called bridge methods) to make overriding
 work with generic types. For example:</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">interface</span> <span class="nc">TestInterface</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">consume</span><span class="o">(</span><span class="n">T</span> <span class="n">value</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">TestClass</span> <span class="kd">implements</span> <span class="n">TestInterface</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">consume</span><span class="o">(</span><span class="n">Integer</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>after type erasure becomes:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">interface</span> <span class="nc">TestInterface</span> <span class="o">{</span>
	<span class="kt">void</span> <span class="nf">consume</span><span class="o">(</span><span class="n">Object</span> <span class="n">value</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">TestClass</span> <span class="kd">implements</span> <span class="n">TestInterface</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">consume</span><span class="o">(</span><span class="n">Integer</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>and we can see that <code class="highlighter-rouge">TestClass</code> no longer overrides
<code class="highlighter-rouge">consume</code> method from <code class="highlighter-rouge">TestInterface</code>. To solve this
problem compiler adds following method to <code class="highlighter-rouge">TestClass</code>:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">TestClass</span> <span class="kd">implements</span> <span class="n">TestInterface</span> <span class="o">{</span>
   <span class="c1">// bridge method added by compiler:</span>
   <span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">consume</span><span class="o">(</span><span class="n">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
	 <span class="k">this</span><span class="o">.</span><span class="na">consume</span><span class="o">((</span><span class="n">Integer</span><span class="o">)</span><span class="n">value</span><span class="o">);</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">consume</span><span class="o">(</span><span class="n">Integer</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<ul>
  <li>Generics don’t work well with overloading, for example following
 overloads are forbidden:</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">check</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ints</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">check</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">strings</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span></code></pre></figure>

<p>because after type erasure both methods have exactly the same signature</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">check</span><span class="o">(</span><span class="n">List</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span></code></pre></figure>

<p>Similarly we cannot implement the same interface twice
with different generic parameters. Again type erasure is our culprit:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Test</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span> <span class="o">}</span>
<span class="c1">// error: Test cannot be inherited with </span>
<span class="c1">//	  different arguments: &lt;Integer&gt; and &lt;String&gt;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestImpl</span> 
	<span class="kd">implements</span> <span class="n">Test</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;,</span> <span class="n">Test</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span> <span class="o">}</span></code></pre></figure>

<h5 id="raw-types-and-unchecked-warnings">Raw types and unchecked warnings</h5>

<p>To maintain backward compatibility Java allows us to use generic types
without specifying generic parameters. Such types are called raw types,
for example:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// preferred usage of generics:</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">typedList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>

<span class="c1">// raw type:</span>
<span class="n">List</span> <span class="n">rawList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">rawList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"foo"</span><span class="o">);</span> <span class="c1">// unchecked warning</span></code></pre></figure>

<p>Raw types can be treated like generic types after type erasure.
Raw types should only be used to interact with legacy code.</p>

<p>When working with raw types compiler may generate an unchecked warning:</p>

<figure class="highlight"><pre><code class="language-nohighlight" data-lang="nohighlight">warning: unchecked call to add(E) as a member of the raw type java.util.List</code></pre></figure>

<p>This warning means that compiler is not sure if we used generic type
correctly and in case that we didn’t we should expect <code class="highlighter-rouge">ClassCastException</code>
at runtime. For example:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ints</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>

  <span class="n">List</span> <span class="n">rawList</span> <span class="o">=</span> <span class="n">ints</span><span class="o">;</span>
  <span class="n">legacyCode</span><span class="o">(</span><span class="n">rawList</span><span class="o">);</span>

  <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">ints</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">// ClassCastException</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">legacyCode</span><span class="o">(</span><span class="n">List</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"foo"</span><span class="o">);</span> <span class="c1">// unchecked warning</span>
<span class="o">}</span></code></pre></figure>

<p>The problem here is that the client of <code class="highlighter-rouge">legacyCode</code> expected that <code class="highlighter-rouge">legacyCode</code>
will add integer to provided list. A simple solution is to use
<code class="highlighter-rouge">List&lt;Object&gt;</code> instead of <code class="highlighter-rouge">List&lt;Integer&gt;</code>
if <code class="highlighter-rouge">legacyCode</code> may add different types to list.
Notice also that line which generated unchecked warning didn’t throw
any exception, exception was thrown later when the
client wanted to access list element.</p>

<p>We may suppress unchecked warning at the method or class level by using
<code class="highlighter-rouge">@SuppressWarnings("unchecked")</code> annotation.</p>

<h4 id="generic-methods">Generic methods</h4>

<p>We can declare generic method as follows:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E1</span><span class="o">,</span><span class="n">E2</span><span class="o">&gt;</span> <span class="n">Pair</span><span class="o">&lt;</span><span class="n">E1</span><span class="o">,</span><span class="n">E2</span><span class="o">&gt;</span> <span class="nf">pair</span><span class="o">(</span><span class="n">E1</span> <span class="n">first</span><span class="o">,</span> <span class="n">E2</span> <span class="n">second</span><span class="o">)</span> <span class="o">{</span>
   <span class="k">return</span> <span class="k">new</span> <span class="n">Pair</span><span class="o">&lt;</span><span class="n">E1</span><span class="o">,</span><span class="n">E2</span><span class="o">&gt;(</span><span class="n">first</span><span class="o">,</span> <span class="n">second</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

<p>Generic methods are invoked like ordinary methods:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Pair</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">pair</span><span class="o">(</span><span class="s">"foo"</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span></code></pre></figure>

<p>In most cases compiler will be able to infer proper values of
generic parameters. When it won’t we can override compiler by
explicitly specifying generic parameters values:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">ClassName</span><span class="o">.&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Number</span><span class="o">&gt;</span><span class="n">staticMethod</span><span class="o">(</span><span class="n">arg1</span><span class="o">,</span> <span class="n">arg2</span><span class="o">);</span>
<span class="c1">// or</span>
<span class="k">this</span><span class="o">.&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span><span class="n">instanceMethod</span><span class="o">(</span><span class="n">arg1</span><span class="o">,</span> <span class="n">arg2</span><span class="o">);</span>

<span class="c1">// syntax error:</span>
<span class="c1">// &lt;String,Integer&gt;method(arg1, arg2);</span></code></pre></figure>

<h4 id="wildcards">Wildcards</h4>

<p>Let’s consider method that copies elements from one list to
another:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">copy</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">dest</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">src</span><span class="o">)</span> <span class="o">{</span>
   <span class="k">for</span> <span class="o">(</span><span class="n">T</span> <span class="nl">element:</span> <span class="n">src</span><span class="o">)</span> <span class="o">{</span>
	  <span class="n">dest</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">element</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>It works perfectly with lists of integers:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">src</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">);</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">dest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">copy</span><span class="o">(</span><span class="n">dest</span><span class="o">,</span> <span class="n">src</span><span class="o">);</span></code></pre></figure>

<p>But fails when we want to copy integers to list of numbers:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">src</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">);</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;</span> <span class="n">nums</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="c1">// error: method cannot be applied to given types</span>
<span class="n">copy</span><span class="o">(</span><span class="n">nums</span><span class="o">,</span> <span class="n">src</span><span class="o">);</span></code></pre></figure>

<p>We may fix method by adding second generic parameter:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">D</span><span class="o">,</span><span class="n">S</span> <span class="kd">extends</span> <span class="n">D</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="nf">copy</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">D</span><span class="o">&gt;</span> <span class="n">dest</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">S</span><span class="o">&gt;</span> <span class="n">src</span><span class="o">)</span> <span class="o">{</span>
   <span class="k">for</span> <span class="o">(</span><span class="n">S</span> <span class="nl">element:</span> <span class="n">src</span><span class="o">)</span> <span class="o">{</span>
	  <span class="n">dest</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">element</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>This is so common situation that Java introduces a shortcut:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">copy</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">dest</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">src</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">T</span> <span class="nl">element:</span> <span class="n">src</span><span class="o">)</span> <span class="o">{</span>
	  <span class="n">dest</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">element</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>Type <code class="highlighter-rouge">List&lt;? extends T&gt;</code> means that this is a list of elements that
extends or implements type <code class="highlighter-rouge">T</code>.</p>

<p>Wildcards allows us to reduce number of required generic parameters and
made method declarations more clear, for example:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">boolean</span> <span class="nf">isNullOrEmpty</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">coll</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">coll</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">coll</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isNullOrEmptyWildcards</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;?&gt;</span> <span class="n">coll</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">coll</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">coll</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure>

<p>Here <code class="highlighter-rouge">Collections&lt;?&gt;</code> means collection of elements of some certain type 
e.g. this may be
<code class="highlighter-rouge">Collection&lt;Object&gt;</code> or <code class="highlighter-rouge">Collection&lt;MyClass&gt;</code>.</p>

<h5 id="super-bound">super bound</h5>

<p><code class="highlighter-rouge">super</code> bound may be used only with wildcards.
<code class="highlighter-rouge">super</code> bound restricts values of wildcard to given class
and all of its superclasses, for example method:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kt">void</span> <span class="nf">process</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span></code></pre></figure>

<p>can only be used with <code class="highlighter-rouge">List&lt;Integer&gt;</code>, <code class="highlighter-rouge">List&lt;Number&gt;</code> and <code class="highlighter-rouge">List&lt;Object&gt;</code>.
Calling method with <code class="highlighter-rouge">List&lt;String&gt;</code> results in compile time error.</p>

<p>While <code class="highlighter-rouge">extends</code> bound is useful when we want to get values
from generic type instance,
<code class="highlighter-rouge">super</code> bound is needed when we want to pass values to generic type instance.
For example:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">produceConsume</span><span class="o">(</span>
	  <span class="n">Producer</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">producer</span><span class="o">,</span>
	  <span class="n">Consumer</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">consumer</span><span class="o">)</span>
<span class="o">{</span>
  <span class="k">for</span><span class="o">(;;)</span> <span class="o">{</span>
	  <span class="n">T</span> <span class="n">value</span> <span class="o">=</span> <span class="n">producer</span><span class="o">.</span><span class="na">produce</span><span class="o">();</span>
	  <span class="n">consumer</span><span class="o">.</span><span class="na">consume</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>Here <code class="highlighter-rouge">Producer</code> may produce type <code class="highlighter-rouge">T</code> or more derived type, and <code class="highlighter-rouge">Consumer</code>
may consume type <code class="highlighter-rouge">T</code> or more general type e.g. <code class="highlighter-rouge">Object</code>. Thanks to
wildcards we may use <code class="highlighter-rouge">produceConsume</code> with <code class="highlighter-rouge">Producer&lt;Integer&gt;</code> and
<code class="highlighter-rouge">Consumer&lt;Object&gt;</code>.</p>

<p>NOTE: Java compiler tries to infer the most specific type for
generic parameters. In call to <code class="highlighter-rouge">produceConsume</code> with <code class="highlighter-rouge">Producer&lt;Integer&gt;</code>
and <code class="highlighter-rouge">Consumer&lt;Object&gt;</code> <code class="highlighter-rouge">Integer</code> will be used as <code class="highlighter-rouge">T</code> parameter value.</p>

<h5 id="wildcard-capture">Wildcard capture</h5>

<p>Let’s say that we want to create a method that swaps elements of
the list, we may write:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">swap</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i1</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i2</span><span class="o">)</span> <span class="o">{</span>
   <span class="c1">// doesn't compile</span>
   <span class="o">?</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i1</span><span class="o">);</span>
   <span class="n">list</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i2</span><span class="o">));</span>
   <span class="n">list</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">i2</span><span class="o">,</span> <span class="n">tmp</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

<p>Unfortunately above code doesn’t compile. We may either
introduce generic parameter to method signature or create
a helper method with generic parameter that 
will “capture” wildcard value:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">swap</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i1</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i2</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">swapImpl</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">);</span>
<span class="o">}</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">swapImpl</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i1</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i2</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">T</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i1</span><span class="o">);</span>
   <span class="n">list</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i2</span><span class="o">));</span>
   <span class="n">list</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">i2</span><span class="o">,</span> <span class="n">tmp</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

<p>Introducing generic parameter is always better solution than
using wildcard capture. I only mention above technique because
it is often used in Java Collection Framework.</p>

<h4 id="covariance-and-contravariance">Covariance and contravariance</h4>

<p>With Java arrays we may write:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">String</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"foo"</span><span class="o">,</span> <span class="s">"bar"</span> <span class="o">};</span>
<span class="n">Object</span><span class="o">[]</span> <span class="n">objects</span> <span class="o">=</span> <span class="n">strings</span><span class="o">;</span></code></pre></figure>

<p>We say that Java arrays are covariant.</p>

<p>Generics in Java are invariant this means that below
code doesn’t compile:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">strings</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"foo"</span><span class="o">,</span> <span class="s">"bar"</span><span class="o">);</span>
<span class="c1">// error: incompatible types</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">objects</span> <span class="o">=</span> <span class="n">strings</span><span class="o">;</span></code></pre></figure>

<p>We must tread <code class="highlighter-rouge">List&lt;String&gt;</code> and <code class="highlighter-rouge">List&lt;Object&gt;</code> as two
distinct types.</p>

<p>Still we may use wildcards to refer to either
<code class="highlighter-rouge">List&lt;String&gt;</code> or <code class="highlighter-rouge">List&lt;Object&gt;</code>:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">strings</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"foo"</span><span class="o">,</span> <span class="s">"bar"</span><span class="o">);</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">objects</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="s">"foo"</span><span class="o">);</span>

<span class="n">List</span><span class="o">&lt;?&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">strings</span><span class="o">;</span>
<span class="n">list</span> <span class="o">=</span> <span class="n">objects</span><span class="o">;</span></code></pre></figure>

<p><code class="highlighter-rouge">List&lt;?&gt;</code> should be treated as superclass of any <code class="highlighter-rouge">List&lt;T&gt;</code>,
because it represents list of objects of some certain type.</p>

<p>We can’t do much with <code class="highlighter-rouge">List&lt;?&gt;</code>, we can only get <code class="highlighter-rouge">Objects</code> from it,
add <code class="highlighter-rouge">null</code>s and ask for size (operations allowed for any list):</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;?&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">strings</span><span class="o">;</span>

<span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
<span class="n">Object</span> <span class="n">value</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">();</span></code></pre></figure>

<p>Operations on <code class="highlighter-rouge">List&lt;?&gt;</code> are limited because we don’t know what types list contains.
We may limit range of possible types with bounds thus gaining
more functionality:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Number</span><span class="o">&gt;</span> <span class="n">numbers</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mf">1.2</span><span class="o">,</span> <span class="mf">3.5</span><span class="o">);</span>
<span class="n">Number</span> <span class="n">num</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span></code></pre></figure>

<p>Now compiler knows that list elements are at least numbers so
we may assign result of <code class="highlighter-rouge">get()</code> to variable of type <code class="highlighter-rouge">Number</code>.
Still we are not able to put anything beyond <code class="highlighter-rouge">null</code> into list,
because we don’t know if this is a list of doubles or a list of integers.</p>

<p>When we want to add elements to list we should use <code class="highlighter-rouge">super</code> bound:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">Number</span><span class="o">&gt;</span> <span class="n">numbers</span> <span class="o">=</span>
   <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"foo"</span><span class="o">,</span> <span class="kc">true</span><span class="o">));</span>

<span class="n">numbers</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
<span class="n">numbers</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mf">3.2</span><span class="o">);</span></code></pre></figure>

<p>Now compiler knows that list holds numbers or elements more general
than numbers e.g. objects, so adding number to list is safe.</p>

<h4 id="how-to-use-generic-types-with-instanceof-and-class">How to use generic types with <code class="highlighter-rouge">instanceof</code> and <code class="highlighter-rouge">class</code></h4>

<p>Because of type erasure types <code class="highlighter-rouge">List&lt;Object&gt;</code> and <code class="highlighter-rouge">List&lt;Integer&gt;</code> are
indistinguishable to JVM. To check if value is instance of <code class="highlighter-rouge">List</code> we
may write:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Object</span> <span class="n">value</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>

<span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="k">instanceof</span> <span class="n">List</span><span class="o">&lt;?&gt;)</span> <span class="o">{</span>
   <span class="c1">// do something</span>
<span class="o">}</span></code></pre></figure>

<p>Similarly types <code class="highlighter-rouge">List&lt;Object&gt;</code> and <code class="highlighter-rouge">List&lt;Integer&gt;</code> are represented
by the same class token:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">integers</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">objects</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;();</span>

<span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">List</span><span class="o">&gt;</span> <span class="n">integersClazz</span> <span class="o">=</span> <span class="n">integers</span><span class="o">.</span><span class="na">getClass</span><span class="o">();</span>
<span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">List</span><span class="o">&gt;</span> <span class="n">objectsClazz</span> <span class="o">=</span> <span class="n">objects</span><span class="o">.</span><span class="na">getClass</span><span class="o">();</span>
<span class="n">Class</span><span class="o">&lt;</span><span class="n">ArrayList</span><span class="o">&gt;</span> <span class="n">arrayListClazz</span> <span class="o">=</span> <span class="n">ArrayList</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>

<span class="c1">// true</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">integersClazz</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">objectsClazz</span><span class="o">));</span>
<span class="c1">// true</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">integersClazz</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">arrayListClazz</span><span class="o">));</span></code></pre></figure>

<p>Notice that in instance test we should use type with wildcard (<code class="highlighter-rouge">List&lt;?&gt;</code>) but to
get class token we should use raw type (<code class="highlighter-rouge">ArrayList.class</code>).</p>

<h4 id="generics-and-arrays">Generics and arrays</h4>

<p>Let’s consider this innocent looking code:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span><span class="o">[]</span> <span class="nf">toArray</span><span class="o">(</span><span class="n">T</span> <span class="n">v1</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">T</span><span class="o">[]</span> <span class="n">array</span> <span class="o">=</span> <span class="o">(</span><span class="n">T</span><span class="o">[])</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span> <span class="c1">// unchecked warning</span>
  <span class="n">array</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">v1</span><span class="o">;</span>
  <span class="k">return</span> <span class="n">array</span><span class="o">;</span>
<span class="o">}</span></code></pre></figure>

<p>Calling this method results in <code class="highlighter-rouge">ClassCastException</code>:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">String</span><span class="o">[]</span> <span class="n">s</span> <span class="o">=</span> <span class="n">toArray</span><span class="o">(</span><span class="s">"foo"</span><span class="o">);</span> <span class="c1">// class cast exception</span></code></pre></figure>

<p>Because we cannot assign <code class="highlighter-rouge">Object[]</code> instance to <code class="highlighter-rouge">String[]</code> variable.
The source of the trouble is type erasure again.
Because value of parameter <code class="highlighter-rouge">T</code> is not accessible at runtime
we don’t know what array we should create - should it be array of
objects or maybe array of strings. We may fix this method by passing
additional parameter that will represent required type of array elements:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span><span class="o">[]</span> <span class="nf">toArray</span><span class="o">(</span><span class="n">T</span> <span class="n">v1</span><span class="o">,</span> <span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">T</span><span class="o">[]</span> <span class="n">array</span> <span class="o">=</span> <span class="o">(</span><span class="n">T</span><span class="o">[])</span> <span class="n">Array</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">type</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
  <span class="n">array</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">v1</span><span class="o">;</span>
  <span class="k">return</span> <span class="n">array</span><span class="o">;</span>
<span class="o">}</span>

<span class="n">String</span><span class="o">[]</span> <span class="n">s</span> <span class="o">=</span> <span class="n">toArray</span><span class="o">(</span><span class="s">"foo"</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span></code></pre></figure>

<p>Now method works as expected but is cumbersome to use.</p>

<p>Another problem with arrays and generics is that we cannot
create array with generic elements - type erasure is culprit again:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// error: generic array creation</span>
<span class="c1">// List&lt;Integer&gt;[] lists = new List&lt;Integer&gt;[3];</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;[]</span> <span class="n">lists</span> <span class="o">=</span> <span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;[])</span> <span class="k">new</span> <span class="n">List</span><span class="o">[</span><span class="mi">3</span><span class="o">];</span></code></pre></figure>

<p>To create array of generic types we must use raw type and cast.</p>

<p>To sum up: you should avoid mixing arrays and generics.</p>

<h4 id="generics-and-varargs">Generics and varargs</h4>

<p>Java varargs methods are implemented using arrays, when we try
to use varargs with generics:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">concat</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">T</span><span class="o">&gt;...</span> <span class="n">lists</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">concatenated</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span>

   <span class="k">for</span> <span class="o">(</span><span class="n">List</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">T</span><span class="o">&gt;</span> <span class="nl">l:</span> <span class="n">lists</span><span class="o">)</span> <span class="o">{</span>
	  <span class="n">concatenated</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">l</span><span class="o">);</span>
   <span class="o">}</span>

   <span class="k">return</span> <span class="n">concatenated</span><span class="o">;</span>
<span class="o">}</span></code></pre></figure>

<p>compiler issues a warning:</p>

<figure class="highlight"><pre><code class="language-nohighlight" data-lang="nohighlight">warning: unchecked generic array creation for varargs parameter</code></pre></figure>

<p>Generic varargs suffer from the same problems as generic arrays.
If we are sure that our code is safe,
we may use <code class="highlighter-rouge">@SafeVarargs</code> annotation to suppress this warning.</p>

<h4 id="additional-resources">Additional resources</h4>

<p>If you want to know more about generics check resources below:</p>

<ul>
  <li><a href="http://a.co/5oMY1hY">Java Generics and Collections: Speed Up the Java Development Process</a></li>
  <li><a href="http://www.angelikalanger.com/GenericsFAQ/JavaGenericsFAQ.html">Java Generics FAQ</a></li>
</ul>



        </section>

        <footer class="post-footer">

            <!-- Everything inside the #author tags pulls data from the author -->
            <!-- #author-->
            
                
                    
                        <figure class="author-image">
                            <a class="img" href="/author/mc" style="background-image: url(/assets/images/mc.png)"><span class="hidden">mc's Picture</span></a>
                        </figure>
                    

                    <section class="author">
                        <h4><a href="/author/mc">Marcin Chwedczuk</a></h4>

                        
                            <p> A programmer, a geek, a human</p>
                        
                        <div class="author-meta">
                            <span class="author-location icon-location"> Warsaw, Poland</span>
                            <span class="author-link icon-link"><a href="http://marcinchwedczuk.pl"> http://marcinchwedczuk.pl</a></span>
                        </div>
                    </section>

                    <!-- /author  -->

                    <section class="share">
                        <h4>Share this post</h4>
                        <a class="icon-twitter" href="http://twitter.com/share?text=Generics in Java&amp;url=http://blog.marcinchwedczuk.plgenerics-in-java"
                            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                            <span class="hidden">Twitter</span>
                        </a>
                        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.marcinchwedczuk.plgenerics-in-java"
                            onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                            <span class="hidden">Facebook</span>
                        </a>
                        <a class="icon-google-plus" href="https://plus.google.com/share?url=http://blog.marcinchwedczuk.plgenerics-in-java"
                           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                            <span class="hidden">Google+</span>
                        </a>
                    </section>
                
            

            <!-- Add Disqus Comments -->
            
                <div id="disqus_thread"></div>
<script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'marcinchwedczukgithubio'; // required: replace example with your forum shortname
        var disqus_identifier = '/generics-in-java';
        var disqus_url = 'http://blog.marcinchwedczuk.pl/generics-in-java';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>

            

        </footer>

    </article>

</main>

<aside class="read-next">

    <!-- [[! next_post ]] -->
    
        <a class="read-next-story " style="background-image: url(/assets/images/mc_cover9.jpeg)" href="/crudest-curd-using-spring">
            <section class="post">
                <h2>Crudest CRUD using Spring</h2>
                <p>EDIT: In this post I'll use Spring XML configuration, in new applications you should definitely...</p>
            </section>
        </a>
    
    <!-- [[! /next_post ]] -->
    <!-- [[! prev_post ]] -->
    
        <a class="read-next-story prev " style="background-image: url(/assets/images/mc_cover6.jpg)" href="/overview-of-spring-annotation-driven-aop">
            <section class="post">
                <h2>Overview of Spring annotation driven AOP</h2>
                <p>In this post I will show you how to use Spring aspects. In contrast to...</p>
            </section>
        </a>
    
    <!-- [[! /prev_post ]] -->
</aside>

<!-- /post -->


        <!-- The tiny footer at the very bottom -->
        <footer class="site-footer clearfix">
          <section class="copyright"><a href="/">Programming is Magic</a> &copy; 2021</section>
          <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> using <a href="https://github.com/jekyller/jasper">Jasper</a></section>
        </footer>
    </div>
    <!-- highlight.js -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- jQuery needs to come before `` so that jQuery can be used in code injection -->
    <script type="text/javascript" src="//code.jquery.com/jquery-1.12.0.min.js"></script>
    <!-- Ghost outputs important scripts and data with this tag -->
    <!--  -->
    <!-- Add Google Analytics  -->
        <!-- Google Analytics Tracking code -->
     <script>
	    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	    ga('create', 'UA-82096342-1', 'auto');
	    ga('send', 'pageview');

     </script>
    <!-- Fitvids makes video embeds responsive and awesome -->
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <!-- The main JavaScript file for Casper -->
    <script type="text/javascript" src="/assets/js/index.js"></script>

</body>
</html>
