<!DOCTYPE html>
<html>
<head>
    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Page Meta -->
    <title>CTF Time: Compile JPHide on Kali Linux</title>
    <meta name="description" content="A place where I share my thoughts about programming." />

    <!-- Mobile Meta -->
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Brand icon -->
    <link rel="shortcut icon" href="/assets/images/favicon.ico" >

    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" />

    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!-- Ghost outputs important style and meta data with this tag -->
        <link rel="canonical" href="http://blog.marcinchwedczuk.pl//compile-jphide-on-linux" />
    <meta name="referrer" content="origin" />
    <link rel="next" href="/page2/" />

    <meta property="og:site_name" content="Programming is Magic" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="CTF Time: Compile JPHide on Kali Linux" />
    <meta property="og:description" content="A place where I share my thoughts about programming." />
    <meta property="og:url" content="http://blog.marcinchwedczuk.pl//compile-jphide-on-linux" />
    <meta property="og:image" content="/assets/images/mc_cover4.jpg" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="CTF Time: Compile JPHide on Kali Linux" />
    <meta name="twitter:description" content="A place where I share my thoughts about programming." />
    <meta name="twitter:url" content="http://blog.marcinchwedczuk.pl//compile-jphide-on-linux" />
    <meta name="twitter:image:src" content="/assets/images/mc_cover4.jpg" />

    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Website",
    "publisher": "Programming is Magic",
    "name": "CTF Time: Compile JPHide on Kali Linux",
    "url": "http://blog.marcinchwedczuk.pl//compile-jphide-on-linux",
    "image": "/assets/images/mc_cover4.jpg",
    "description": "A place where I share my thoughts about programming."
}
    </script>

    <meta name="generator" content="Jekyll 3.0.0" />
    <link rel="alternate" type="application/rss+xml" title="Programming is Magic" href="/feed.xml" />


</head>
<body class="home-template nav-closed">

    <!-- The blog navigation links -->
    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        <li class="nav-home " role="presentation"><a href="/">Home</a></li>
        <!-- <li class="nav-about " role="presentation"><a href="/about">About</a></li> -->

        
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/java">
                    java (29)
                    <!-- compile-jphide-on-linux name: java -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/dotnet">
                    dotnet (11)
                    <!-- compile-jphide-on-linux name: dotnet -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/algorithms">
                    algorithms (7)
                    <!-- compile-jphide-on-linux name: algorithms -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/architecture">
                    architecture (7)
                    <!-- compile-jphide-on-linux name: architecture -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/scala">
                    scala (7)
                    <!-- compile-jphide-on-linux name: scala -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/javascript">
                    javascript (5)
                    <!-- compile-jphide-on-linux name: javascript -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/polish">
                    polish (5)
                    <!-- compile-jphide-on-linux name: polish -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/csharp">
                    csharp (4)
                    <!-- compile-jphide-on-linux name: csharp -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/elektronika">
                    elektronika (4)
                    <!-- compile-jphide-on-linux name: elektronika -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/hibernate">
                    hibernate (3)
                    <!-- compile-jphide-on-linux name: hibernate -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/linux">
                    linux (3)
                    <!-- compile-jphide-on-linux name: linux -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/unit-testing">
                    unit-testing (3)
                    <!-- compile-jphide-on-linux name: unit-testing -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/hardware-review">
                    hardware-review (2)
                    <!-- compile-jphide-on-linux name: hardware-review -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/cheatsheet">
                    cheatsheet (1)
                    <!-- compile-jphide-on-linux name: cheatsheet -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/ctf">
                    ctf (1)
                    <!-- compile-jphide-on-linux name: ctf -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/devcon">
                    devcon (1)
                    <!-- compile-jphide-on-linux name: devcon -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/eclipse">
                    eclipse (1)
                    <!-- compile-jphide-on-linux name: eclipse -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/electronics">
                    electronics (1)
                    <!-- compile-jphide-on-linux name: electronics -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/functional-programming">
                    functional-programming (1)
                    <!-- compile-jphide-on-linux name: functional-programming -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/git">
                    git (1)
                    <!-- compile-jphide-on-linux name: git -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/hacking">
                    hacking (1)
                    <!-- compile-jphide-on-linux name: hacking -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/hardware">
                    hardware (1)
                    <!-- compile-jphide-on-linux name: hardware -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/kotlin">
                    kotlin (1)
                    <!-- compile-jphide-on-linux name: kotlin -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/low-level">
                    low-level (1)
                    <!-- compile-jphide-on-linux name: low-level -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/other">
                    other (1)
                    <!-- compile-jphide-on-linux name: other -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/postman">
                    postman (1)
                    <!-- compile-jphide-on-linux name: postman -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/powershell">
                    powershell (1)
                    <!-- compile-jphide-on-linux name: powershell -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/regex">
                    regex (1)
                    <!-- compile-jphide-on-linux name: regex -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/security">
                    security (1)
                    <!-- compile-jphide-on-linux name: security -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/sql">
                    sql (1)
                    <!-- compile-jphide-on-linux name: sql -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/ssh">
                    ssh (1)
                    <!-- compile-jphide-on-linux name: ssh -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/tips">
                    tips (1)
                    <!-- compile-jphide-on-linux name: tips -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/vim">
                    vim (1)
                    <!-- compile-jphide-on-linux name: vim -->
                </a>
            </li>
        
            
            
            <li class="nav-about " role="presentation">
                <a href="/tag/windows">
                    windows (1)
                    <!-- compile-jphide-on-linux name: windows -->
                </a>
            </li>
        

   </ul>
    <a class="subscribe-button icon-feed" href="/feed.xml">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The comment above "< default" means - insert everything in this file into -->
    <!-- the [body] of the default.hbs template, which contains our header/footer. -->

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->



<header class="main-header post-head " style="background-image: url(/assets/images/mc_cover4.jpg) ">
    <nav class="main-nav  overlay  clearfix">
        <a class="blog-logo" href="/"><img src="/assets/images/home.png" alt="Blog Logo" /></a>
        
            <a class="menu-button icon-menu" href="#"><span class="word">Menu</span></a>
        
    </nav>
</header>

<main class="content" role="main">

    <article class="post tag-test tag-content">

        <header class="post-header">
            <h1 class="post-title">CTF Time: Compile JPHide on Kali Linux</h1>
            <section class="post-meta">
            <!-- <a href='/'>mc</a> -->

            
                
                    <a href='/author/mc'>Marcin Chwedczuk</a>
                
            
            <time class="post-date" datetime="2021-01-25">25 Jan 2021</time>
                <!-- [[tags prefix=" on "]] -->
                
                on
                
                    
                       <a href='/tag/ctf'>Ctf</a>,
                    
                
                    
                       <a href='/tag/jvmbloggers'>Jvmbloggers</a>
                    
                
                
            </section>
        </header>

        <section class="post-content">

            <p>Recently I started participating in CTF (capture the flag) games.
One of the challenges that I needed to solve, was to recover a
message hidden in a JPEG file.
To solve this challenge I needed an old steganography tool called <code class="highlighter-rouge">jphide</code>.</p>

<p>The tool is no longer maintained, but you can still find copies of its source
code on Github, e.g. <a href="https://github.com/h3xx/jphs">h3xx/jphs</a>.</p>

<p>Let’s see how we can compile it on a “stock” Kali Linux image.
BTW The best way to start with Kali Linux is to grab
images from <a href="https://www.offensive-security.com/kali-linux-vm-vmware-virtualbox-image-download/">offensive-security.com</a> site and load them into
VM Ware Player or VirtualBox. The default user:password is <code class="highlighter-rouge">kali:kali</code>.</p>

<p>TIP Since I got addicted to iTerm2, I often prefer to SSH into Kali VM from iTerm2
instead of using Kali itself. Stock Kali comes with a preinstalled SSH server,
we just need to enable it with <code class="highlighter-rouge">sudo service ssh start</code>.</p>

<p>OK finally its time to compile jphide:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nv">$ </span>git clone <span class="nt">--depth</span> 1  https://github.com/h3xx/jphs</code></pre></figure>

<p>First we need to compile <code class="highlighter-rouge">jpeg-8a</code> library:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nv">$ </span><span class="nb">cd </span>jphs/jpeg-8a
<span class="nv">$ </span>./configure
<span class="nv">$ </span>make all</code></pre></figure>

<p>After compilation, a new folder called <code class="highlighter-rouge">.libs</code> should be created:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nv">$ </span><span class="nb">ls</span> .libs/lib<span class="k">*</span>
.libs/libjpeg.so  .libs/libjpeg.so.8  .libs/libjpeg.so.8.0.1
<span class="nv">$ </span><span class="nb">cd</span> .. <span class="c"># we are done here</span></code></pre></figure>

<p>Because we have not installed <code class="highlighter-rouge">libjpeg.so.8</code> system-wide we need
to modify <code class="highlighter-rouge">Makefile</code> before we can compile the main program:</p>

<figure class="highlight"><pre><code class="language-diff" data-lang="diff"><span class="gd">--- a/Makefile
</span><span class="gi">+++ b/Makefile
</span><span class="gu">@@ -15,8 +15,8 @@ JP_CFLAGS = $(CFLAGS_COMMON) \
</span>            -I./jpeg-8a
 BF_CFLAGS = $(CFLAGS_COMMON)

<span class="gd">-LIBS = -ljpeg
-LDFLAGS = $(LIBS)
</span><span class="gi">+LDFLAGS = -L./jpeg-8a/.libs
+LDLIBS = -ljpeg
</span>
 ## programs
 INSTALL = install</code></pre></figure>

<p>As a side note let’s notice that author of this <code class="highlighter-rouge">Makefile</code> made a cardinal sin
of linking: never, Never, NEVER put linked libraries into <code class="highlighter-rouge">LDFLAGS</code>. Always pass them
to linker using <code class="highlighter-rouge">LDLIBS</code> variable.</p>

<p>To patch the <code class="highlighter-rouge">Makefile</code> just save the diff as e.g. <code class="highlighter-rouge">patch1</code> and
then execute <code class="highlighter-rouge">patch &lt; patch1</code> in <code class="highlighter-rouge">jphs</code> directory.</p>

<p>After patching <code class="highlighter-rouge">Makefile</code> we are ready to build the tools:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nv">$ </span>make clean
<span class="nv">$ </span>make</code></pre></figure>

<p>On some systems you may encounter a compilation problem on line
208 of <code class="highlighter-rouge">jpseek.c</code>:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="k">if</span> <span class="p">((</span><span class="n">f</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">seekfilename</span><span class="p">,</span><span class="n">O_WRONLY</span><span class="o">|</span><span class="n">O_TRUNC</span><span class="o">|</span><span class="n">O_CREAT</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span></code></pre></figure>

<p>You can fix it by adding a third parameter to <code class="highlighter-rouge">open</code> call:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="k">if</span> <span class="p">((</span><span class="n">f</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">seekfilename</span><span class="p">,</span><span class="n">O_WRONLY</span><span class="o">|</span><span class="n">O_TRUNC</span><span class="o">|</span><span class="n">O_CREAT</span><span class="p">,</span> <span class="mo">0644</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span></code></pre></figure>

<p>EDIT: I forgot to mention this in the original post.
Because we did not installed <code class="highlighter-rouge">jpeg-8a</code> library system wide,
we need to set <code class="highlighter-rouge">LD_LIBRARY_PATH</code> variable:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nv">$ </span><span class="nb">export </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:<span class="k">$(</span>realpath ./jpeg-8a/.libs/<span class="k">)</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$LD_LIBRARY_PATH</span>
:/home/kali/jphs/jpeg-8a/.libs</code></pre></figure>

<p>Now the program should run without any problems:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nv">$ </span>./jphide
jphide, version 0.3 <span class="o">(</span>c<span class="o">)</span> 1998 Allan Latham &lt;alatham@flexsys-group.com&gt;

This is licenced software but no charge is made <span class="k">for </span>its use.
NO WARRANTY whatsoever is offered with this product.
NO LIABILITY whatsoever is accepted <span class="k">for </span>its use.
You are using this entirely at your OWN RISK.
See the GNU Public Licence <span class="k">for </span>full details.

Usage:

jphide input-jpg-file output-jpg-file hide-file</code></pre></figure>

<h2 id="bonus---cracking-mode">Bonus - cracking mode</h2>

<p>Because during CTF you often have to crack the password using
<code class="highlighter-rouge">/usr/share/dict/words</code> or <code class="highlighter-rouge">rockyou.txt</code> lists, its convenient
to have <code class="highlighter-rouge">jpseek</code> version that can quickly check which passwords
are good candidates for further analysis.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nv">$ </span>cp jpseek.c jpcrack.c</code></pre></figure>

<p><b>The patch assumes that you have added the third parameter to the <code class="highlighter-rouge">open</code> call.</b></p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nv">$ </span>patch jpcrack.c crack-patch</code></pre></figure>

<p>And here is the <code class="highlighter-rouge">crack-patch</code> itself:</p>

<figure class="highlight"><pre><code class="language-diff" data-lang="diff"><span class="gd">--- jpseek.c
</span><span class="gi">+++ jpcrack.c
</span><span class="gu">@@ -6,12 +6,11 @@
</span>  * Use permitted under terms of GNU Public Licence only.
  *
  */
<span class="gd">-
</span><span class="gi">+#define _GNU_SOURCE
</span> #include &lt;stdio.h&gt;
 #include &lt;string.h&gt;
 #include &lt;stdlib.h&gt;
 #include &lt;ctype.h&gt;
<span class="gd">-#include &lt;fcntl.h&gt;
</span> #include &lt;unistd.h&gt;
 #include &lt;getopt.h&gt;
 #include &lt;errno.h&gt;
<span class="gu">@@ -20,11 +19,13 @@
</span> #include &lt;sys/time.h&gt;		
 #include &lt;sys/resource.h&gt;		
 #include &lt;sys/stat.h&gt;		
<span class="gi">+#include &lt;fcntl.h&gt;
</span> #include "bf.h"
 #include "cdjpeg.h"
 #include "version.h"
 
 #define NKSTREAMS 4
<span class="gi">+#define PASSLEN 120
</span> 
 static jvirt_barray_ptr * coef_arrays;
 static unsigned int  cpos[NKSTREAMS];
<span class="gu">@@ -187,10 +188,10 @@
</span> 
 
 static int jpseek (const char* infilename,
<span class="gd">-                   const char* seekfilename)
</span><span class="gi">+		   const char* pass)
</span> {
<span class="gi">+ int result = 0;
</span>  int b,count,i,j,len0,len1,len2;
<span class="gd">- char *pass;
</span>  unsigned char iv[9];
  unsigned char v;
  struct jpeg_decompress_struct srcinfo;
<span class="gu">@@ -201,14 +202,10 @@
</span> 
  input_file = fopen(infilename,"r");
  if (input_file == NULL) {
<span class="gd">-  perror("Can't open input file");
-  return (1);
</span><span class="gi">+	perror("Can't open input file");
+	exit(2);
</span>  }	
 
<span class="gd">- if ((f = open(seekfilename,O_WRONLY|O_TRUNC|O_CREAT, 0644)) &lt; 0) {
-  perror("Can't open seek file");
-  return (1);
- }
</span> 
  srcinfo.err = jpeg_std_error(&amp;jsrcerr);
  jpeg_create_decompress(&amp;srcinfo);
<span class="gu">@@ -232,14 +229,9 @@
</span>   iv[i] = (((short**)(((void**)(((void**)coef_arrays)[0]))[0]))[0])[i]; 
  }
 
<span class="gd">- pass = getpass("Passphrase: ");
- if (strlen(pass) == 0) {
-  fprintf(stderr,"Nothing done\n");
-  exit(0);
- }  
</span>  if (strlen(pass) &gt; 120) {
   fprintf(stderr,"Truncated to 120 characters\n");
<span class="gd">-  pass[120] = 0;
</span><span class="gi">+	exit(3);
</span>  }
 
  Blowfish_ExpandUserKey(pass,strlen(pass),bkey);
<span class="gu">@@ -266,8 +258,8 @@
</span>   v = 0;
   for(j=0;j&lt;8;j++) {
    if ((b = get_bit()) &lt; 0) {
<span class="gd">-    fprintf(stderr,"File not completely recovered\n");
-    exit(1);
</span><span class="gi">+	result = 1;
+	goto end;
</span>    }
    b = b &lt;&lt; j;
    v |= b;
<span class="gu">@@ -291,25 +283,27 @@
</span>  while(count &lt; length) {
   for(j=0;j&lt;8;j++) {
    if ((b = get_bit()) &lt; 0) {
<span class="gd">-    fprintf(stderr,"File not completely recovered\n");
-    exit(1);
</span><span class="gi">+	result = 1;
+	goto end;
</span>    }
    b ^= get_code_bit(1);
    v = v &lt;&lt; 1;
    v |= b;
    tail--;
   }
<span class="gd">-  write(f,&amp;v,1);
</span><span class="gi">+  //write(f,&amp;v,1);
</span>   count++;
  }
 
<span class="gi">+end:
+
</span>  jpeg_finish_decompress(&amp;srcinfo);
  jpeg_destroy_decompress(&amp;srcinfo);
 
<span class="gd">- close(f);
</span><span class="gi">+ //close(f);
</span>  fclose(input_file);
 
<span class="gd">- return(0);
</span><span class="gi">+ return result;
</span> 
 }
 
<span class="gu">@@ -332,14 +326,40 @@
</span> static void usage()
 {
  fprintf(stderr,"Usage:\n\n\
<span class="gd">-jpseek input-file seek-file\n\n");
</span><span class="gi">+jpseek input-file passwords-list-file\n\n");
</span>  exit(1);
 }
 
 int main(int argc, char **argv)
 {
<span class="gd">- intro();
- if (argc != 3) usage();
- return (jpseek(argv[1],argv[2]));
</span><span class="gi">+ if (argc != 3) { 
+   usage(); exit(10);
+}
+
+ char buff[128] = {0};
+
+ FILE* pass_file = fopen(argv[2],"r");
+ if (pass_file == NULL) {
+	perror("Can't open passwords file");
+	exit(20);
+ }	
+
+ long counter = 0;
+ while (fgets(buff, 120, pass_file) != NULL) {
+	// get rid of \n
+	buff[strcspn(buff, "\n")] = 0;
+	counter++;
+
+	printf("[trying=%s]\n", buff);
+	if (jpseek(argv[1], buff) == 0) {
+		puts(buff);
+	}
+
+	if ((counter % 100000) == 0) {
+		fprintf(stderr, "(stderr) currently at %s\n", buff);
+	}
+ }
+
+ return 0;
</span> }</code></pre></figure>

<p>And finally the diff for <code class="highlighter-rouge">Makefile</code>:</p>

<figure class="highlight"><pre><code class="language-diff" data-lang="diff"><span class="gd">-- Makefile.orig	2021-01-31 08:49:57.904938275 -0500
</span><span class="gi">+++ Makefile	2021-01-31 08:50:12.068602369 -0500
</span><span class="gu">@@ -1,6 +1,7 @@
</span> # variables
 HDOBJECTS = jphide.o bf.o
 SKOBJECTS = jpseek.o bf.o
<span class="gi">+CROBJECTS = jpcrack.o bf.o
</span> 
 ## flags
 CFLAGS_COMMON = -O2
<span class="gu">@@ -29,19 +30,21 @@
</span> BINDIR = $(PREFIX)/bin
 
 # targets
<span class="gd">-TARGETS = jphide jpseek
</span><span class="gi">+TARGETS = jphide jpseek jpcrack
</span> all: $(TARGETS)
 jphide: $(HDOBJECTS)
 jpseek: $(SKOBJECTS)
<span class="gi">+jpcrack: $(CROBJECTS)
</span> 
 # object rules
 bf.o:			CFLAGS=$(BF_CFLAGS)
<span class="gd">-jphide.o jpseek.o:	CFLAGS=$(JP_CFLAGS)
</span><span class="gi">+jphide.o jpseek.o jpcrack.o:	CFLAGS=$(JP_CFLAGS)
</span> 
 # dependencies
 bf.c: bf.h bf_config.h
 jphide.c: ltable.h version.h bf.h
 jpseek.c: ltable.h version.h bf.h
<span class="gi">+jpcrack.c: ltable.h version.h bf.h
</span> 
 # other targets
 clean:</code></pre></figure>

<h2 id="demo-time">Demo time</h2>

<p>Let’s hide a message in a cat picture:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nv">$ </span>wget https://upload.wikimedia.org/wikipedia/commons/4/4b/Domestic_Cat_Demonstrating_Dilated_Slit_Pupils.jpg <span class="nt">-O</span> cat.jpg
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"very secret message"</span> <span class="o">&gt;</span> msg.txt
<span class="nv">$ </span>./jphide cat.jpg flag.jpg msg.txt
<span class="c"># Enter password</span>
<span class="nv">$ </span><span class="nb">cat </span>passlist.txt                   
<span class="nb">cat
</span>dog
abcd
1234
<span class="nv">$ </span>./jpcrack flag.jpg passlist.txt 
<span class="o">[</span><span class="nv">trying</span><span class="o">=</span><span class="nb">cat</span><span class="o">]</span>
<span class="o">[</span><span class="nv">trying</span><span class="o">=</span>dog]
<span class="o">[</span><span class="nv">trying</span><span class="o">=</span>abcd]
abcd
<span class="o">[</span><span class="nv">trying</span><span class="o">=</span>1234]
<span class="c"># Looks like 'abcd' is a good candidate</span>
<span class="nv">$ </span>./jpseek flag.jpg out.txt
<span class="nv">$ </span><span class="nb">cat </span>out.txt
very secret message</code></pre></figure>

<p>You can get rid of <code class="highlighter-rouge">[trying...</code> text by commenting appropriate <code class="highlighter-rouge">printf</code>
in the <code class="highlighter-rouge">jpcrack.c</code>.</p>


        </section>

        <footer class="post-footer">

            <!-- Everything inside the #author tags pulls data from the author -->
            <!-- #author-->
            
                
                    
                        <figure class="author-image">
                            <a class="img" href="/author/mc" style="background-image: url(/assets/images/mc.png)"><span class="hidden">mc's Picture</span></a>
                        </figure>
                    

                    <section class="author">
                        <h4><a href="/author/mc">Marcin Chwedczuk</a></h4>

                        
                            <p> A programmer, a geek, a human</p>
                        
                        <div class="author-meta">
                            <span class="author-location icon-location"> Warsaw, Poland</span>
                            <span class="author-link icon-link"><a href="http://marcinchwedczuk.pl"> http://marcinchwedczuk.pl</a></span>
                        </div>
                    </section>

                    <!-- /author  -->

                    <section class="share">
                        <h4>Share this post</h4>
                        <a class="icon-twitter" href="http://twitter.com/share?text=CTF Time: Compile JPHide on Kali Linux&amp;url=http://blog.marcinchwedczuk.plcompile-jphide-on-linux"
                            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                            <span class="hidden">Twitter</span>
                        </a>
                        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.marcinchwedczuk.plcompile-jphide-on-linux"
                            onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                            <span class="hidden">Facebook</span>
                        </a>
                        <a class="icon-google-plus" href="https://plus.google.com/share?url=http://blog.marcinchwedczuk.plcompile-jphide-on-linux"
                           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                            <span class="hidden">Google+</span>
                        </a>
                    </section>
                
            

            <!-- Add Disqus Comments -->
            
                <div id="disqus_thread"></div>
<script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'marcinchwedczukgithubio'; // required: replace example with your forum shortname
        var disqus_identifier = '/compile-jphide-on-linux';
        var disqus_url = 'http://blog.marcinchwedczuk.pl/compile-jphide-on-linux';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>

            

        </footer>

    </article>

</main>

<aside class="read-next">

    <!-- [[! next_post ]] -->
    
        <a class="read-next-story " style="background-image: url(/assets/images/mc_cover6.jpg)" href="/fabgl-pcemulator-na-esp32">
            <section class="post">
                <h2>FabGL PCEmulator na ESP32</h2>
                <p>Jakieś dwa tygodnie temu natknąłem się na artykuł [Emulating the IBM PC on an ESP32](https://hackaday.com/2021/07/28/emulating-the-ibm-pc-on-an-esp32/). Opisano...</p>
            </section>
        </a>
    
    <!-- [[! /next_post ]] -->
    <!-- [[! prev_post ]] -->
    
        <a class="read-next-story prev " style="background-image: url(/assets/images/mc_cover4.jpg)" href="/filter-by-exception-message-log4j2">
            <section class="post">
                <h2>Filtering log lines using exception messages in log4j2</h2>
                <p>Recently I needed to filter out messages logged by a bit too verbose library. This...</p>
            </section>
        </a>
    
    <!-- [[! /prev_post ]] -->
</aside>

<!-- /post -->


        <!-- The tiny footer at the very bottom -->
        <footer class="site-footer clearfix">
          <section class="copyright"><a href="/">Programming is Magic</a> &copy; 2021</section>
          <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> using <a href="https://github.com/jekyller/jasper">Jasper</a></section>
        </footer>
    </div>
    <!-- highlight.js -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- jQuery needs to come before `` so that jQuery can be used in code injection -->
    <script type="text/javascript" src="//code.jquery.com/jquery-1.12.0.min.js"></script>
    <!-- Ghost outputs important scripts and data with this tag -->
    <!--  -->
    <!-- Add Google Analytics  -->
        <!-- Google Analytics Tracking code -->
     <script>
	    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	    ga('create', 'UA-82096342-1', 'auto');
	    ga('send', 'pageview');

     </script>
    <!-- Fitvids makes video embeds responsive and awesome -->
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <!-- The main JavaScript file for Casper -->
    <script type="text/javascript" src="/assets/js/index.js"></script>

</body>
</html>
